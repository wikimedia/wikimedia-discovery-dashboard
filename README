== Updating the dashboards in this repository

This repository contains only the code that wraps around and
provisions the dashboards, not the dashboard itself. The dashboards
are kept as git submodules. To update this repository to point
at the latest master branch of the metrics dashboard issue the
following:

$ cd shiny-server/metrics
$ git pull --ff-only
$ cd -
$ git commit -m 'Bump dashboard submodule' shiny-server/metrics
$ git review

This will create a commit named 'Bump dashboard submodule' and
push it to gerrit for review.

==Running in labs

Go to Special:NovaInstance on wikitech and start a new instance. The
The small instance with 2GB of memory is sufficient. Leave the image
type at the default of 'debian-8.1-jessie' and click go. Wait for
the instance to start, then login via ssh.

First we need to clone the repository:
$ sudo git clone https://gerrit.wikimedia.org/r/wikimedia/discovery/dashboard /srv/dashboards

Then we need to provision everything:
$ sudo bash /srv/dashboards/setup.sh

shiny-server should now be running on port 3838. To make this
available to the world visit Special:NovaProxy in wikitech. Point a
subdomain at the instance and make sure to port 3838 as the instance
port.

==Running on your machine

Should be a simple `vagrant up`.

==Updating

From inside the instance (ssh for labs, vagrant ssh for vagrant):

$ cd /srv/dashboards
$ sudo git pull --ff-only
$ sudo git submodule update --init --recursive
$ sudo service shiny-server restart

==Adding dashboards

On your local clone:

$ cd <path to repo>
$ git submodule add <URL to repo>.git shiny-server/<name>
$ <git add, commit, etc.>
$ git review

